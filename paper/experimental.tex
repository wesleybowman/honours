%\include{header}
%
%\begin{document}

\chapter{Experimental Procedure} \label{chap:Experimental}

\section{Slide Preparation}

Most of the objects that was observed were placed on slides. This was done
since most of the samples were biological or in a suspension. Glass slides and
cover slips were used. These had to be properly cleaned before any object could
be placed on them for viewing, since dirt and other materials would degrade the
resolution of the hologram. Once the slide and cover slip was cleaned, they
were placed on lens paper, which was done to keep them clean, and not pick up
any dirt off of the table.

The rest of the slide preparation depending on the object that was to be
viewed. If the sample did not need to be put in a suspension or solution, then
the object could be placed directly on the slide, with the cover slip on top to
secure it. This was the case for the onion cells (picture)
%, shown in Figure~\ref{fig:onionSlide}

PICTURE OF ONION SLIDE HERE

If the object needed a suspension, then a well had to be made on the slide. The
well was made out of vacuum grease. This was done to make a seal between the
slide and the cover slip, while also allowing liquid to stay in-between the two
surfaces.
The well is shown in Figure~\ref{fig:well}.
This was a delicate procedure, since any part of the slide touched by the
vacuum grease was rendered useless for any kind of reconstruction. The vacuum
grease was usually applied with a toothpick.

\begin{figure}[htbp!]
\begin{center}
    \includegraphics[scale=0.05]{pictures/well.jpg}
\end{center}
\caption{A slide with a well made out of vacuum grease.}
\label{fig:well}
\end{figure}

The suspension itself had to be created by diluting the material that was to be
observed. This was done by taking the sample, and placing a small amount in a
large amount of water. This new solution could be further diluted by taking
some of the solution and placing it in more water. This could be done as many
times as needed to obtain a usable solution. The final solution needs to be
sparsely populated with the original sample, that way there is enough material
so that a reconstruction can be done, but not too much material so that there
are too many fridges and nothing can be resolved. This was done for most of the
samples used%(picture)
, and a sample slide is shown in Figure~\ref{fig:solutionSlide}.

%PICTURE OF SOLUTION SLIDE HERE
\begin{figure}[htbp!]
\begin{center}
    \includegraphics[scale=0.05]{pictures/solution.jpg}
\end{center}
\caption{A well that was filled with solution and had a cover slip placed on
top to seal the solution in.}
\label{fig:solutionSlide}
\end{figure}

Typically, to get the right solution, many dilutions need to be made. For most
of the samples, four or five dilutions were made before any imaging was done,
that way it was easy to image, since usually one of the dilutions made would be
sparse enough for imaging.
After the solution was made, it was piped into the well with care taken as to
avoid air bubbles. Bubbles will appear in holograms and take away from your
resolution, sometimes covering up the material you want to image. After the
solution was in the well, the cover slip was place on until it was nicely
sealed so that none of the solution would leak out. The slide could then be
placed on the slide holder%(picture)
, shown in Figure~\ref{fig:slideHolder}

%PICTURE OF SLIDE HOLDER
\begin{figure}[htbp!]
\begin{center}
    \includegraphics[scale=0.05]{pictures/slideHolder.jpg}
\end{center}
\caption{The slide holder that was made to easily place and adjust the slide
after preparation. The slide is held on with double-sided tape.}
\label{fig:slideHolder}
\end{figure}


\section{Taking the Holograms}

After the slides have been prepared, a hologram can be taken of the object. The
laser must first be turned on. Once the beam is on, all of the components need
to be lined up so that the laser goes through the first objective, the object,
and through the second objective, and is fully captured by the CCD\@. This can
take a bit of fine tuning with the three-axis mounts. Once all of the
components are lined up, the object can be moved about to find an area of
interest within the solution or sample. This is done so that the resolution can
be maximized and to make sure that the object that was intended for viewing is
in frame. Sometimes, the object needs to be moved because in this part of the
solution there are too many objects, and the overcrowding will result in no
possible reconstruction, since there are too many fridges. 

Once a good object
is in place, the second objective and the CCD can be moved. This is done to
find the focal point of the second objective. Once the focal point is found,
the object can be adjusted toward or away from the objective to create fridges,
which lead to the reconstructions. The camera moves to get the most of the
image onto the CCD\@. The fridges are important, and can be finicky. Too many,
and there will be a loss in resolution, sometimes so much so that there is no
reconstruction to be had. Not enough, and again, there can be a loss of
resolution or a loss of the reconstruction itself. Once the setup is properly
aligned, a hologram can be taken. Once all the images have been recorded on the
CCD, the memory card can be taken from the camera and the data can be analyzed.

\section{Analyzing the Holograms}

Now that the images have been taken, they can be put onto a computer for
analyzing. The images were taken in a raw format. This was done to ensure that
no information was lost to the compression of the photos in the camera.
Therefore, the images had to be converted to a workable, yet still lossless
format. The raw images were converted into TIFF images using DCRaw%~\cite{DCRaw},
CITE GOES HERE
which is an
open-source program available for all platforms. The following command was the
one used to convert all the RW2 files (which is the raw file type that the
camera outputted) into a 16-bit TIFF file.

\begin{center}
\begin{lstlisting}[frame=none, language=bash, numbers=none]
dcraw -6 -T *.RW2
\end{lstlisting}
\end{center}
The -6 is what makes the program write 16 bits per sample instead of eight, and
the -T is how we get the output to be TIFF files. 16-bit TIFF files were used
since that reduced the amount of information lost in the images. TIFF images
are preferable over most other formats, but PNG could also be used. 16-bit TIFF
files cannot be viewed by most programs, so a more typical approach is to go
with the 8-bit TIFF files. RW2 is not the only type of raw
file, but DCRaw covers most raw formats that will be produced.

Now that the images have been converted to a workable format, the
reconstruction could be done. The reconstruction process was done with HoloPy,
which is an open-source module in Python developed by Tom Dimiduk et al.\ at Manoharan Group at
Harvard University. A sample of the general code run is shown in
Listing~\ref{listing:code}. For every reconstruction done, there is a separate
piece of code for that specific hologram, so that the conditions used to create
that reconstruction are kept, and so that the hologram can easily be
reconstructed at any time.


\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  %numbers=none,
  numberstyle=\tiny\color{gray},
  keywords=[2]{as},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true
  tabsize=3
}

\begin{Code}[scale=0.75,htbp!]
    \centering
\begin{lstlisting}[caption=Code for a general reconstruction, label=listing:code]
import holopy as hp
import numpy as np
import matplotlib.pyplot as plt

#Set the magnification of the second objective
magnification = 20

#Get the spacing between pixels
Spacing = 6.8/magnification

#Set the optics of the system
optics = hp.core.Optics(wavelen=.66, index=1.33, polarization=[1.0, 0.0])

#Get the background image so that it may be subtracted 
#off to give a better reconstruction
bg = hp.load('backgroundImage.tiff', spacing=Spacing, optics=optics)

#Load the object image
obj = hp.load('objectHologram.tiff', spacing=Spacing, optics=optics)

#Get the distances to reconstruction the image at
d = np.linspace(400, 600, 5)

#Create the hologram to be reconstructed with the background 
#subtracted off
holo = obj - bg

#Display the hologram before reconstruction
hp.show(holo)
plt.show()

#Do the reconstruction
rec = hp.propagate(holo, d)

#Display the hologram after reconstruction
hp.show(rec)
plt.show()

\end{lstlisting}
\end{Code}

The beauty of using HoloPy is the simplicity which it allows for. The first 3
lines of Listing~\ref{listing:code} are import statements, which loads in the
modules that we will need. NumPy is a scientific library, and MatPlotLib is a
library that allows for the visualization of the data. Next, the magnification
of the second objective is set. This is done so that the spacing can be set.
The spacing is set so that when the reconstructions are done, measurements can
be accurately taken of the reconstructed objects. The optics of the system are
set next, which allows for information such as the wavelength and the index of
refraction to be set. Since glass was used in the slides, the refractive index
for glass was used.

The background image and the object hologram image is
loaded, with the spacing and optics parameters passed so that all the
information is with the loaded images. The next thing is to get the distances
at which the reconstruction is to be done at. This is done with a NumPy
function called linspace, which takes the parameters of a start point, a stop
point, and how many points in between are needed. All of these parameters vary
depending on the images. A limiting factor is the amount of random access
memory, or RAM, that the computer has. The more slices you make of the
reconstruction, the more memory needed. The resolution of the images will
determine how much memory is needed, which is why the parameters must be
manipulated to achieve optimum results in runtime. Next, the background is
subtracted from the object hologram. This allows for a higher constrast image,
as gets rid of the fridges from the material that was in the image that was not
desired. This includes things such as dust or dirt that may have been on the
CCD or the other optical parts in the system, or on the slides themselves.
The background subtracted hologram is then shown to the user. This is to make
sure that all of the right information has been given to the program. This is
just a check, and is not needed after the first run.

Finally, the hologram is
reconstructed. This is done by passing the background subtracted hologram and
the distances at which the hologram is to be reconstructed at to the function
propagate. This is where the program takes the most amount of time. After this,
the reconstruction is plotted, and all the slices can be viewed by pressing the
arrow keys. A nice functionality of HoloPy is that when the user left or right
clicks on the image, the coordinates are printed. These coordinates are both
the pixel and spacing coordinates, which allows for measurements to be taken.

















%\bibliographystyle{plain}
%\bibliography{biblio}


%\end{document} 
