%\include{header}
%\begin{document}

\chapter{Introduction} \label{chap:Intro}

Holography was invented by Dennis Gabor in 1948, and he developed the technique
of the in-line holography, while he was trying to improve the resolution of
electron microscopes. He proposed a lensless, two-step process which he called
wavefront reconstruction and is now known as holography .
Gabor realized that when a reference wave and a scattered wave from an object
interfer, then information about both the amplitude and the phase of the
scattered waves can be recorded, despite the fact that the recording medium
only captures the intensity of the light from the waves \cite{Goodman}.
Later, in 1960, Emmett N. Leith and Juris Upatnieks developed
off-axis holography. Schnars et. al said that,

\begin{quote}
``A hologram is the photographically or otherwise recorded
interference pattern between a wavefield scattered from the
object and a coherent background, called the reference wave.
A hologram is usually recorded on a flat surface, but contains
information about the entire three-dimensional wavefield.
This information is coded in the form of bright and dark
microinterferences, usually not visible for the human eye due
to the high spatial frequencies. The object wave can be
reconstructed by illuminating the hologram with the reference
wave again. This reconstructed wave is indistinguishable from
the original object wave. An observer sees a three-dimensional
image which exhibits all the effects of perspective and depth
of focus.``\cite{schnars_digital_2002}
\end{quote}
Contrary to popular belief, many of the most interesting and useful properties
of holography are different and independent of this ability to view a
three-dimensional object, a lot of which are discussed in later chapters of
this thesis. Some applications of holography include microscopy, which
motivated much of the early work in holography, and volume reconstructions.
Holography is advantageous in this area since in conventional microscopy, high
lateral resolution is achieved at the price of a limited depth of focus. This
can be fixed by continuously refocusing, but this approach is unsatisfactory.
With a hologram, the object can be recorded and all the information is retained
to do a full volume exploration from one image.
Another interesting application of holography is the ability to take
multiple-exposures of holograms, which allows the hologram to store two or more
separate complex wave fields on the same recording medium, and subsequent
interference of those fields when reconstructed together. This allows for
changes in local refractive-index perturbations of air to be seen, so that
things like shock waves from a bullet, or being able to image the gas expansion
of an incandescent bulb, can be seen. This interferometry also allows for
contour generation, which lets the object easily be seen as having contours in
a two dimensional image, and vibrational analysis of objects, which allows for
the vibration of a diaphragm, as shown in Figure~\ref{fig:vibrationAnalysis}, to be seen.

\begin{figure}[htbp!]
\begin{center}
    \includegraphics[width=0.6\textwidth]{pictures/vibrationAnalysis.jpg}
\end{center}
\caption{The difference between two different frequencies on a diaphragm, shown
    using holography interferometry \cite{vibration}.}
\label{fig:vibrationAnalysis}
\end{figure}


Numerical reconstruction of holograms was started in 1972 by Yaroslavskii
\emph{et al.} This was done by sampling optically enlarged parts of an in-line
holograms that were recorded on a photographic plate. These digitalized
holograms were then reconstructed numerically. A large development in
holography was made when Schnars and J\"{u}ptner directly recorded holograms
onto a charged coupled device, or a CCD \cite{schnars_digital_2002}.
This enabled for holograms to not only
be numerically reconstructed, but also digitally sampled directly, getting rid
of the photographic plates that were needed, and the conversion of those
photographic plates into digitalized holograms.

A fundamental problem of holography is that a hologram must be recorded, and
later reconstructed, getting both the amplitude and the phase information out
of the hologram, however, the recording medium only responds to the light
intensity. The way this is solved, is by using a reference wave with the object
wave, both of which are mutually coherent, and then the intensity of the sum of
the two complex fields then depends on both the amplitude and phase of the
object wave. Therefore, if
\begin{equation}
    S(x,y) = \left| S(x,y) \right | \exp{[i\phi(x,y)]}
\end{equation}
represents the object wavefront to be reconstructed, and
\begin{equation}
    A(x,y) = \left| A(x,y) \right | \exp{[i\psi(x,y)]}
\end{equation}
represents the reference wavefront with which $S(x,y)$ interfers, the intensity
of the sum is given by
\begin{equation}
    I(x,y) = \left| A(x,y) \right |^2 + \left| S(x,y) \right |^2 + 2\left|
    A(x,y) \right |\left| S(x,y) \right |\cos{\left[ \psi(x,y)-\phi(x,y) \right]}
    \label{eq:intensity}
\end{equation}
The first two terms of Equation~\ref{eq:intensity} depend only on the
intensities of the individual incoming wavefronts, while the third depends on
their relative phases. Thus, information about both the amplitude and the phase
of $S(x,y)$ have been recorded in the hologram \cite{Goodman}.

Holography has two basic methods of obtaining holograms, in-line holography and
off-axis holography. There are different types of those techniques, but those
are the two broad categories in which holography can be situated into. For
in-line holography, which is the technique used through this thesis, the
reference wave is scattered off the object, creating the object wavefront, but
the object is aligned in such a way that the reference wave is till recorded on
the recording medium. This allows for all of the components of the holographic
microscope to be placed in a linear setup. Off-axis holography splits the
incoming reference wavefront using a beam splitter, and using one of the split
beams to scatter off of the object, and the other as the reference wavefront.
This requires a more complicated setup than in-line holography, since it
requires more components to make sure everything is aligned properly.

In this work, the objective was to create a digital in-line holographic
microscope that would allow for holograms to be created and then numerically
reconstructed. In Chapter~\ref{chap:Math}, the mathematical background of
holographic reconstruction is discussed in some detail, along with information
needed to achieve efficient computation time for the reconstructions. In
Chapter~\ref{chap:Micro}, the microscope setup along with the sample and slide
setup are discussed. Chapter~\ref{chap:Experimental} discusses how the
holograms were recorded, and once they were recorded how they were
reconstructed numerically. Chapter~\ref{chap:Results} the reconstructions
obtained from Harvard and Acadia Universities are shown and discussed. In
Chapter~\ref{chap:Conclusion}, conclusions are drawn and where this work could
go in the future are discussed.

%PAGE 469 of GUENTHERE


%
%
%Different methods to obtain a hologram: These are all basically all the
%different optical systems that can be used to obtain a hologram.  This list is
%not extensive.
%
%\begin{itemize} \item in-line (Gabor) holograms - This is the optical system in
%            which the object is illuminated by a collimated beam of
%            monochromatic light along an axis normal to the photographic plate.
%            (Basics of Holography- P. Hariharan)
%
%    \item off-axis (Leiths-Upatnieks) holograms - In this optical system, the
%        source beam is split, and half of the beam is used as a reference beam,
%        and goes directly to the photographic plate. The other half of the beam
%        is directed to the object and then to the photographic plate.  \item
%            fourier holograms -
%
%    \item lenless-fourier holograms \item image holograms gets a only the real
%    image of the object \item reflection holograms
%
%
%\end{itemize}
%
%Different types of holograms:
%
%\begin{itemize} \item thin  and thick holograms come about when looking at the
%            thickness of the recording medium.  If the thickness of the
%            recording medium is larger than the average spacing of the fringes,
%            then volume effects cannot be neglected. For our purposes, the CCD
%            camera is a thin recording medium I believe.  If $Q<1$ then it's a
%            thin grating, else its a thick grating, where Q is \begin{equation}
%                Q=2\pi\lambda_{0}d/n_{0}\Lambda^2 \label{Q} \end{equation}
%
%    \item volume transmission \item volume reflection \item digital holograms
%    \item pinhole holograms \item Fraunhofer holograms
%
%\end{itemize}

\chapter{Mathematical Background} \label{chap:Math}
In this chapter, the mathematical background needed to understand how a
hologram is formed and how to reconstruct the holograms numerically are
discussed, along with how to obtain efficient numerical reconstructions using
the fast Fourier transform (FFT) algorithm instead of direct evaluation of the Fresnel integral.

\section{Fresnel-Kirchoff Integral}

The Fresnel-Kirchoff integral is the key equation required for holograms
to be reconstructed numerically.
The diffraction of a light wave through an aperture, which is fastened perpendicular
to the incoming beam, is described by the Fresnel-Kirchoff integral
\cite{schnars_digital_2002}:

    \begin{figure}
    \begin{center}
        \includegraphics[scale=0.5]{smallangle}
    \end{center}
    \caption{The angle, $\theta$, between $\rho$, the distance between a point
    in the hologram plane and a point in the reconstruction plane, as
    referenced to the $z$-axis}
    \label{fig:smallangle}
    \end{figure}

\begin{equation}
    \Gamma(\xi,\eta) =
    \frac{1}{\lambda}\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}h(x,y)R(x,y)\frac{\exp\left(
        -i\frac{2\pi}{\lambda} \right)\rho}{\rho}\times \left(
        \frac{1}{2}+\frac{1}{2}\cos\theta \right)~dx~dy
        \label{fresnel-kirchoff}
    \end{equation}
    with

    \begin{equation}
        \rho = \sqrt{(x-\xi)^{2}+(y-\eta)^{2}+d^{2}}
    \end{equation}
    where $h(x,y)$ is the hologram function, $R(x,y)$ is the reference wave
    function, $\rho$ is the distance between a point in the hologram plane and
    a point in the reconstruction plane, $d$ is the distance from the hologram
    to the image plane, and $\lambda$ is the wavelength of the laser being used. 
    In Figure~\ref{fig:smallangle}, it is shown that $\theta$ is the angle
    between a point in the hologram plane, denoted with $x$ and $y$
    coordinates, and a point in the reference plane, denoted with $\xi$ and
    $\eta$.
    If a plane wave reference wave is used,
    then $R(x,y)$ is given by the real amplitude, $r$:

    \begin{equation}
        R = r+ i0 = r
    \end{equation}

    If the values of $x$ and $y$ along with the values of $\xi$ and $\eta$ are
    small compared the the distance between the planes, $d$, then $\rho$ can be
    replaced with a Taylor series,
    %approximated to the first terms:

    \begin{equation}
        \rho=d+\frac{(\xi-x)^{2}}{2d}+\frac{(\eta-y)^{2}}{2d}-\frac{1}{8}\frac{\left[
        (\xi-x)^{2}+(\eta-y)^{2} \right]}{d^{3}} + \cdots
    \end{equation}

    \begin{equation}
        \rho\approx d+\frac{(\xi-x)^{2}}{2d}+\frac{(\eta-y)^{2}}{2d}
        \label{eq:distance}
    \end{equation}
    %
    where only terms linear in $1/d$ are considered.

    Using Equation~\ref{eq:distance}, along with a small angle approximation, the Fresnel-Kirchoff
    integral can be simplified to

    \begin{equation}
        \begin{aligned}
        \Gamma(\xi,\eta) &= \frac{i}{\lambda d} \exp\left( -i\frac{2\pi}{\lambda}d \right)
        \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}h(x,y)R(x,y) \\
        & \times \exp\left[ -i\frac{\pi}{\lambda d}\left(
        (\xi-x)^{2}+(\eta-y)^{2} \right) \right]~dx~dy .
        \end{aligned}
    \end{equation}
Pulling the constants out of the integral and simplifying gives

    \begin{equation}
        \begin{aligned}
        \Gamma(\xi,\eta) &= \frac{i}{\lambda d} \exp\left( -i\frac{2\pi}{\lambda}d \right)
        \exp\left[ -i\frac{\pi}{\lambda d}(\xi^2+\eta^2) \right] \\
        &\times \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}h(x,y)R(x,y)
        \exp\left[ -i\frac{\pi}{\lambda d}\left(
        x^{2}+y^{2} \right) \right] \\
        & \times \exp\left[ i\frac{2\pi}{\lambda d}\left(
        x\xi+y\eta \right) \right]~dx~dy .
        \end{aligned}
        \label{eq:last}
    \end{equation}

    The intensity is simply the magnitude of the reconstruction squared,

    \begin{equation}
        I(\xi,\eta) = |\Gamma(\xi,\eta)|^{2} ,
    \end{equation}

    and the phase can be calculated using
    \begin{equation}
        \phi(\xi,\eta)=\arctan\left(
        \frac{\mathrm{Im}[\Gamma(\xi,\eta)]}{\mathrm{Re}[\Gamma(\xi,\eta)]}
        \right).
    \end{equation}
%    where Re and Im correspond to the real and the imaginary parts of the
%    reconstruction respectively.

    In order to digitize Equation~\ref{eq:last} we introduce the variable
    transformations of

    \begin{equation}
        \nu = \frac{\xi}{\lambda d} \qquad \mu = \frac{\eta}{\lambda d}
        \label{eq:original}
    \end{equation}
    which are the spatial frequencies, so that the Fresnel integral can be
    written as,

    \begin{equation}
        \begin{aligned}
        \Gamma(\nu,\mu) &= \frac{i}{\lambda d}
        \exp\left[ -i\pi\lambda d(\nu^2+\mu^2) \right] 
        \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}h(x,y)R(x,y) \\
        &\times \exp\left[ -i\frac{\pi}{\lambda d}\left(
        x^{2}+y^{2} \right) \right]
        \exp\left[ i2\pi\left(
        x\nu+y\mu \right) \right]~dx~dy.
        \end{aligned}
        \label{eq:variableFresnel}
    \end{equation}

    It can be seen from this Equation~\ref{eq:variableFresnel}, that the Fresnel approximation is the
    inverse Fourier transformation,

    \begin{equation}
    \begin{aligned}
        \Gamma(\nu,\mu)&=\frac{i}{\lambda d}\exp\left[ -i\pi\lambda d\left(
            \nu^2+\mu^2
        \right) \right] \\
        & \mathfrak{F}^{-1}\left\{R(x,y)h(x,y)\exp\left[
            -i\frac{\pi}{\lambda d}(x^{2}+y^2)
        \right] \right\} .
    \end{aligned}
    \label{eq:FFTneeded}
    \end{equation}

    Now if the hologram function is sampled on a rectangular raster of $N\times M $
    points, with steps between neighbouring pixels on the CCD being $\Delta x$ and $\Delta
    y$ in the horizontal and vertical directions, respectively, then the
    integrals can be converted into finite sums using these discrete values:

    \begin{equation}
    \begin{aligned}
        \Gamma(m,n) &= \frac{i}{\lambda d}\exp\left[ -i\pi \lambda d\left(
            m^2\Delta \nu^2 + n^2\Delta \mu^2
        \right)\right]\\
        & \times
        \sum_{k=0}^{N-1}\sum_{k=0}^{M-1}R(k,l)h(k,l)\exp\left[ -i
        \frac{\pi}{\lambda d}\left( k^2\Delta x^2+l^2\Delta y^2 \right)
    \right] \\
    & \times \exp\left[ i2\pi\left( k\Delta x m \Delta\nu+l\Delta y n
    \Delta\mu \right) \right] .
    \end{aligned}
    \label{eq:discrete}
    \end{equation}
    According to the theory of Fourier transform among $\Delta x$, $\Delta y$
    and $\Delta\nu$, and $\Delta\mu$ the following relation can be defined:

    \begin{equation}
        \Delta\nu=\frac{1}{N\Delta x}; \qquad \Delta\mu=\frac{1}{M\Delta y}.
        \label{eq:transform}
    \end{equation}
    Now substituting the original variables used in Equation~\ref{eq:original} into
    Equation~\ref{eq:transform} we have

    \begin{equation}
        \Delta\xi=\frac{\lambda d}{N\Delta x}; \qquad \Delta\eta=\frac{
        \lambda d}{M\Delta y},
    \end{equation}
    and plugging these expressions back into Equation~\ref{eq:discrete} results
    in

    \begin{equation}
    \begin{aligned}
        \Gamma(m,n) & = \frac{i}{\lambda d}\exp\left[ -i\pi \lambda d\left(
            \frac{m^2}{N^2\Delta x^2}+\frac{n^2}{M^2\Delta y^2}
        \right)\right]\\
        &\times
        \sum_{k=0}^{N-1}\sum_{k=0}^{M-1}R(k,l)h(k,l)\exp\left[ -i
        \frac{\pi}{\lambda d}\left( k^2\Delta x^2+l^2\Delta y^2 \right)
    \right] \\
    &\times \exp\left[ i2\pi\left( \frac{km}{N}+\frac{ln}{M} \right) \right].
    \end{aligned}
    \end{equation}
    This is a discrete Fresnel transform, and it is calculated by multiplying
    $R(k,l)$ by $h(k,l)$ and $\exp\left[ -i
        \frac{\pi}{\lambda d}\left( k^2\Delta x^2+l^2\Delta y^2 \right)
    \right]$
    and then applying an inverse Fourier transform to the product. This is done
    the most effectively using the fast Fourier transform, or FFT\@, as
    discussed in Section~\ref{sect:FFT}. The factor
    in front of the sum only affects the phase and can be neglected for
    most applications.


%        \section{Fourier Transform}
%
%        In science, one of the most fundamental principles is the superposition
%        principle. The superposition principle tells us that for a linear system
%        composed of different functions is the sum of the responses that would have
%        been caused by the different functions individually. Green's function is
%        written as the
%        superposition of infinitely many impulse response functions, which then makes
%        the response a superposition of impulse responses. Fourier transforms are like
%        Green's function, but instead of using impulse response functions, it uses
%        sinusoids instead.
%
%        Think of sinusoids (sines and cosines) as being the fundamental building blocks
%        for functions. From these functions, we can write any other function as a
%        superposition of those two functions, whether they be periodic or not. This can
%        be represented with an infinite series, known as the Fourier series.
%
%        First, let's suppose that $f(t)$ is a periodic function with a period
%        $T$, so that
%        \begin{equation}
%            f(t)=f(t+T)
%        \end{equation}
%        for all values of $t$ \cite{DanielSteck}. We can represent this as
%
%        \begin{equation}
%            f(t) = a_0 + b_0 + 2\sum_{n=1}^{\infty} a_n \cos(n\omega
%            t)+2\sum_{n=1}^{\infty}b_n\sin(n\omega t)
%            \label{eq:fourierseries}
%        \end{equation}
%        where $\omega=2\pi\nu=\frac{2\pi}{T}$ is the angular frequency, and $\nu$ is the frequency.
%        We can define the complex Fourier coefficient as
%
%        \begin{equation}
%            c_n \equiv a_n+ib_n
%        \end{equation}
%        which allows for Equation~\ref{eq:fourierseries} to be rewritten as
%
%        \begin{equation}
%            f(t) = a_0 + b_0 +\sum_{n=1}^{\infty} a_n \left( e^{in\omega t} +
%            e^{-in\omega t} \right) - i\sum_{n=1}^{\infty} b_n \left( e^{in\omega t} -
%            e^{-in\omega t} \right)
%        \end{equation}
%        This can be simplified farther
%
%        \begin{equation}
%            f(t) = \sum_{n=-\infty}^{\infty}a_ne^{-in\omega t} + i\sum_{n=-\infty}^{\infty}b_ne^{-in\omega t}
%        \end{equation}
%
%        Now, using the complex Fourier coefficient defined earlier, we can get the
%        complex Fourier series
%
%        \begin{equation}
%            f(t)=\sum_{n=-\infty}^{\infty}c_ne^{-in\omega t}
%        \end{equation}
%
%        Now, these same harmonic functions can be used to build aperiodic functions. An
%        aperiodic function corresponds to $T\rightarrow \infty$, so we need a
%        continuous spectrum to represent an aperiodic function, since there is more
%        information in the function than the aperiodic case.
%
%        \begin{equation}
%            f(t)=\sum_{n=-\infty}^{\infty}c_ne^{-in\omega t} \rightarrow
%            f(t)=\frac{1}{2\pi}\int_{-\infty}^{\infty} \tilde{f}(\omega) e^{-i\omega t}~d\omega
%        \end{equation}
%        This is the inverse Fourier transform. To find the amplitudes, $c_n$, which are
%        also called the Fourier transform,
%
%        \begin{equation}
%            c_n = \frac{1}{T}\int_0^Te^{in\omega t} f(t) dt \rightarrow
%            \tilde{f}(\omega) =\int_{-\infty}^{\infty}f(t)e^{i\omega t}~dt
%        \end{equation}
%        In a more common notation,
%
%        \begin{equation}
%            \mathfrak{F} =\int_{-\infty}^{\infty}f(t)e^{i\omega t}~dt
%            \qquad
%            \mathfrak{F}^{-1} =\int_{-\infty}^{\infty}f(\omega)e^{-i\omega t}~d\omega
%        \end{equation}
%        where $\mathfrak{F}$ is the Fourier transform of  $f(t)$ and
%        $\mathfrak{F}^{-1}$ is the inverse Fourier transform of $f(t)$.
%
%
%*=============================================================================================*

    \section{Fast Fourier Transform (FFT) \label{sect:FFT}}

    The image reconstruction of a hologram, Equation~\ref{eq:FFTneeded},
    requires the calculation of Fourier transforms and the fast Fourier
    transform provides incredible computational speedups when compared to the
    calculations using the discrete Fourier transform (DFT).
%
%        The fast Fourier transform is one of the most prized algorithms in the
%        world, since it is such a commonly used algorithm, and provides
%        incredible speedups when compared to the discrete Fourier transform.
%
        The most commonly used FFT algorithm is known as the Cooley-Tukey algorithm.
        This is a recursive algorithm and the basic idea is to take a DFT and split it
        into smaller DFTs. For example, taking a $n$ size DFT and transforming it into
        two DFTs of size $n_1$ and $n_2$ respectively.

        The discrete Fourier transform of an array $X$ with $n$ complex numbers is the array
        $Y$ given by

        \begin{equation}
            Y[k] = \sum_{j=0}^{n-1}X[j]\omega_n^{jk}
            \label{eq:dft}
        \end{equation}
        where $0\le k < n$ and $\omega_n=\exp\left( -2\pi\sqrt{-1}/n \right)$
        \cite{frigo2005design}.
        $\omega_n$ is known as the twiddle factor. The problem
        with the DFT is that it requires \BigO{n^{2}} operations.

        The Cooley-Tukey algorithm can be derived from Equation~\ref{eq:dft}. If
        $n$ can be factored into $n=n_1n_2$, then we can rewrite
        Equation~\ref{eq:dft}
        letting $j=j_1n_2+j_2$ and $k=k_1+k_2n_2$.

        \begin{equation}
            Y[k_1+k_2n_2]=\sum_{j_2=0}^{n_2-1}\left[ \left( \sum_{j_1=0}^{n_1-1}
                X[j_1n_2+j_2]w_{n_1}^{j_1k_1} \right)w_n^{j_2k_1} \right]w_{n_2}^{j_2k_2}
            \end{equation}


            Fast Fourier transforms,
            have \BigO{n \log n} operations, which is more efficient
            computationally than the DFT's \BigO{n^2} operations. This
            difference in the number of operations required to compute a FFT is clearly shown in
            Figure~\ref{fig:dftVSfft}, a plot of the operations required for
            DFT and FFT methods up to $n=1\times 10^{12}$.
            %which only shows up to $n=20$, yet, 
            The difference for $n=1\times 10^{12}$ is about 10 orders of
            magnitude. For the reconstructions involved in this thesis, $n$ was
            $12\times 10^{6}$ resulting in a computational speed up of about 4
            orders of magnitude.
            %already about a factor of 8 operations.

            \begin{figure}[htbp!]
                \begin{center}
                    \includegraphics[scale=0.5]{dftVSfft2}
                \end{center}
                \caption{A plot of the difference between \BigO{n^2} operations and
                \BigO{n\log n} operations as used in DFT and FFT computations,
            respectively.}
                \label{fig:dftVSfft}
            \end{figure}


            The Cooley-Tukey algorithm computes $n_2$ DFTs of size $n_1$, multiples the
            result by the twiddle factors, and then computes $n_1$ DFTs of size
            $n_2$. This decomposition is then implemented recursively until the
            butterfly is reached. A term that comes up a
            lot in FFT is the radix, which is used to describe an $n_1$ or $n_2$ that is
            bounded. The small DFT of the radix is traditionally called a butterfly. The
            Cooley-Tukey algorithm also rearranges the DFT of $X$ into a sum over the even
            and odd indices.
            For example, if $n=8$, and a radix-2 algorithm was used, then it would split it
            into $n_1=4$ and $n_2=4$. The algorithm would then split the data into many
            size-2 DFTs called butterfly operations \cite{frigo2005design}.
            %Figure~\ref{fig:radix-2} shows this process.
%
%%        \begin{figure}[htbp!]
%%            \begin{center}
%%                \includegraphics[scale=0.5]{radix-2}
%%            \end{center}
%%            \caption{An example of $n=8$, radix-2 FFT.}
%%            \label{fig:radix-2}
%%        \end{figure}
%
%            \begin{figure}[htbp!]
%                \begin{center}
%                    \includegraphics[scale=0.75]{radix-2.pdf}
%                \end{center}
%                \caption{An example of $n=8$, radix-2 FFT.}
%                \label{fig:radix-2}
%            \end{figure}
%
%            The Cooley-Tukey algorithm isn't without it's own problems. The main problem is
%            that the $n_1$ dimension corresponds to discontiguous inputs $j_1$ in
%            $X$, but contiguous outputs in $k_1$ in $Y$, and vice versa for $n_2$.
%            This is a matrix transpose for a single decomposition stage, and the
%            composition of all such transpositions is a digit-reversal permutation
%            (or, bit reversal for radix-2). The contiguous and discontiguous
%            operations are better shown in Figure~\ref{fig:DFT2D}. The result of the discontiguous memory
%            access and data reordering  hinders the efficient use of hierarchical memory
%            architectures efficiencies (cache). The bit reversal technique is shown
%            in Table~\ref{tab:bitreversal}.
%
%            \begin{figure}[htbp!]
%                \begin{center}
%                    \includegraphics[scale=0.5]{DFT2D}
%                \end{center}
%                \caption{Another diagram of how a DFT works, showing contiguous and
%                non-contiguous operations.}
%                \label{fig:DFT2D}
%            \end{figure}
%
%            \begin{table}[htbp!]
%                \begin{center}
%                    \caption{Bit reversal done on the indices of an array.}
%                    \label{tab:bitreversal}
%                    \begin{tabular}{|c|c|c|c|}
%                        \hline
%                        index & binary & bit reversal & bit rev.\ index \\
%                        \hline
%                        0 & 000 & 000 & 0 \\
%                        1 & 001 & 100 & 4 \\
%                        2 & 010 & 010 & 2 \\
%                        3 & 011 & 110 & 6 \\
%                        4 & 100 & 001 & 1 \\
%                        5 & 101 & 101 & 5 \\
%                        6 & 110 & 011 & 3 \\
%                        7 & 111 & 111 & 7 \\
%                        \hline
%                    \end{tabular}
%                \end{center}
%            \end{table}
%


            \section{Convolution and the Convolution Theorem}

            The convolution theorem allows for an integral to be evaluated as
            the product of two fast Fourier transforms and an inverse Fourier
            transform. This is useful for numerical analysis since integration
            can be difficult and slow to do numerically, while the FFT is
            simpler and more computationally efficient.

            Convolution is a mathematical operation that maps a pair of
            functions to a function and can be defined as \cite{DanielSteck},
            \begin{equation}
                (f*g)(x) \equiv \int_{-\infty}^{\infty} f(x')g(x-x')dx' .
                \label{eq:convolution}
            \end{equation}
            If we allow $g(x')$ to be a localized function, then we call this a
            convolution kernel and
            allows us to think of the convolution
            as the value at location $x$ as the amount of $f(x')$ that passes
            through $g(x')$ when $g$ is displaced by an amount $x$. For example,
            let $g(x) = \delta(x)$ and the convolution with $f(x)$ is
            \begin{equation}
                (f*\delta)(x)=\int_{-\infty}^{\infty}f(x')\delta(x-x')dx'=f(x).
            \end{equation}
            The convolution gives us back the original function $f(x)$, and it
            does this because the $\delta$-function is a perfectly localized
            function. Now, if we displace the $\delta$-function by some amount, $g(x)=\delta(x-x_0)$,
            we get
            \begin{equation}
                (f*\delta)(x)=\int_{-\infty}^{\infty}f(x')\delta(x-x')dx'=f(x-x_0),
            \end{equation}
            the original function shifted along $x$ by a distance $x_0$

            Convolution integrals appear often in physics, but as has been discussed, doing an
            integral numerically can be slow, especially when the function, $f(x)$,
            is large and complex as encountered in an image. 
            Fortunately, the convolution theorem provides a way to efficiently evaluate
            Equation~\ref{eq:convolution}. The convolution theorem states that the
            Fourier transform of the convolution is the product of the Fourier
            transforms of the individual functions \cite{DanielSteck}:
            \begin{equation}
                \mathfrak{F}\left[ f*g
                \right]=\mathfrak{F}[f]\mathfrak{F}[g] ,
            \end{equation}
            thereby allowing us to write the convolution operation as,
            \begin{equation}
                f*g = \mathfrak{F}^{-1}\left\{\mathfrak{F}[f]\mathfrak{F}[g]
            \right\}.
            \end{equation}
%            Using this formulation of the convolution, we can use the FFT which is
%            fast and efficient computationally, and allows us to easily process the
%            convolution. 
            The convolution theorem is of great use in numerically
            reconstructing holograms, since it allows in this thesis for the Fresnel-Kirchoff
            integral to be rewritten in terms of fast Fourier transforms as
            discussed in the following section.

            %DANIEL STECK PAGE 187-189


    \section{Image Reconstruction}

    The Fresnel-Kirchoff integral is not very computationally efficient
    leading to long computation times even for a small hologram, and this process can be
    sped up by transforming the Fresnel-Kirchoff integral into fast Fourier
    transforms.
    Using the convolution approach to the Fresnel-Kirchoff integral,
    Equation~\ref{fresnel-kirchoff} can be transformed into
    \cite{schnars_digital_2002},

    \begin{equation}
        \Gamma(\xi,\eta) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
        h(x,y)R(x,y) g(\xi,\eta,x,y)~dx~dy,
        \label{eq:superpositionIntegral}
    \end{equation}
    where $g(\xi,\eta,x,y)$ is the impulse response function and is given by

    \begin{equation}
        g(\xi,\eta,x,y)=\frac{1}{\lambda}\frac{\exp\left[
        -i\frac{2\pi}{\lambda}\sqrt{d^{2}+(x-\xi)^{2}+(y-\eta)^{2}}
    \right]}{\sqrt{d^{2}+(x-\xi)^{2}+(y-\eta)^{2}}}.
        \label{impulse}
    \end{equation}
    Once again, the small angle approximation was used. The small angle
    approximation is justified since the distance between the object and the
    charged coupled device (CCD) was never large enough to cause the angle,
    $\theta$, to become larger than 30 degrees. Figure~\ref{fig:smallangle}
    shows the geometry between the hologram and the imaging plane.
%    \begin{figure}
%    \begin{center}
%        \includegraphics[scale=0.5]{smallangle}
%    \end{center}
%    \caption{The angle, $\theta$, between $\rho$, the distance between a point
%    in the hologram plane and a point in the reconstruction plane, and the
%$z$-axis}
%    \label{fig:smallangle}
%    \end{figure}

    Equation~\ref{impulse}
    shows that the impulse response function is space-invariant, which allows the
    use of the convolution theorem. This means that we can rewrite
    Equation~\ref{eq:superpositionIntegral} with the Fourier transforms

    \begin{equation}
        \Gamma(\xi,\eta) = \mathfrak{F}^{-1}\left\{ \mathfrak{F}(R\cdot h)
        \cdot\mathfrak{F}(g) \right\} .
        \label{eq:convReconstruction}
    \end{equation}

    The impulse response function is a delta function that is known to
    mathematicians as a Green's function,
    and in optics as the point spread function. The impulse response is
    a way of remembering past events and is used as a weighting function in the
    convolution integral. The weighting function serves as a window through which a
    time average is performed and the window determines how much of the past history
    of the function can be seen when the time average is performed
    \cite{guenther_modern_1990}.
    %GUENTHER 240-241

    The impulse response function in 2D and in 3D are shown in
    Figures~\ref{fig:pointSpreadFunction} (a) and (b), respectively.
    %and Figure~\ref{fig:psf3D} respectively.

    \begin{figure}[htbp!]
        \ContinuedFloat
        \begin{center}
        \begin{subfigure}[t]{\textwidth}
            \includegraphics[width=\textwidth]{psf}
%            \caption{A 2D representation of the impulse response function.}
            \caption{}
            \label{fig:psf}
        \end{subfigure}
        \end{center}
        %\label{fig:pointSpreadFunction}
    \end{figure}

    \begin{figure}[htbp!]
        \ContinuedFloat
        \begin{center}
        \begin{subfigure}[t]{0.5\textwidth}
            \includegraphics[width=\textwidth]{psf3D}
            \caption{}
            %\caption{A 3D representation of the impulse response function generated from the 2D plot in
            %    Figure~\ref{fig:psf}.}
            \label{fig:psf3D}
        \end{subfigure}
        \end{center}
        \caption{The impulse response function displayed in 2D (a) and 3D (b).
        The axes are in pixels with the height of the impulse response function
    being in arbitrary units.}
        \label{fig:pointSpreadFunction}
    \end{figure}

%    \begin{figure}[htbp!]
%        \begin{center}
%            \includegraphics[scale=0.25]{psf3D}
%        \end{center}
%            \label{fig:psf3D}
%        \end{figure}

    The numerical realization of the impulse response function is

    \begin{equation}
        g(k,l)=\frac{i}{\lambda}=\frac{\exp\left[
        -i\frac{2\pi}{\lambda}\sqrt{d^2+\left(k-\frac{N}{2}\right)^2\Delta x^2+\left(
        l-\frac{N}{2}
    \right)^{2}\Delta y^2} \right]}{\sqrt{d^2+\left(k-\frac{N}{2}\right)^2\Delta x^2+\left(
        l-\frac{M}{2}
    \right)^{2}\Delta y^2}} .
    \end{equation}
    The Fourier transform of $g(k,l)$ can be calculated and expressed
    analytically

    \begin{equation}
        G(n,m) = \exp\left\{ -i\frac{2\pi
        d}{\lambda}\sqrt{1-\frac{\lambda^{2}\left( n+\frac{N^2\Delta
        x^2}{2d\lambda} \right)^2}{N^2\Delta x^2}-\frac{\lambda^{2}\left( m+\frac{M^2\Delta
        y^2}{2d\lambda} \right)^2}{M^2\Delta y^2}} \right\} ,
    \end{equation}
    thereby saving one Fourier transformation calculation allowing for
    Equation~\ref{eq:convReconstruction} to be rewritten as

    \begin{equation}
        \Gamma(\xi,\eta) = \mathfrak{F}^{-1}\left\{ \mathfrak{F}(R\cdot h)
        \cdot G \right\} .
        \label{eq:finalEquation}
    \end{equation}

    Equation~\ref{eq:finalEquation} is how HoloPy, the open-source library that
    was used to do the numerical reconstructions of the holograms, performs
    reconstructions. For the holograms used, a background image was always
    taken so that it could be subtracted from the hologram. This background
    subtracted image was then used as the hologram $h$ in the reconstructions.
    A background subtracted image allowed for less noise in the image, as well
    as higher contrast and image quality, since only the object being viewed
    would be included in the reconstruction.



%*=============================================================================================*



    %\cite{guenther_modern_1990}
    %$\cite{moon_automated_2009}
    %\cite{frigo2005design}
    %\cite{DanielSteck}


%\bibliographystyle{plain}
%\bibliography{HonoursBiblio/HonoursBiblio.bib}
%
%\end{document} 
